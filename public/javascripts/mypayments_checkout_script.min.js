LoadCheckoutPaymentContext(function (Checkout, PaymentOptions) {
  var AcmeExternalPaymentOption = PaymentOptions.ExternalPayment({
    id: "seba_mypayments_redirect",
    fields: {billing_address: true},
    onSubmit: function (callback) {
      let storeId = Checkout.getData("storeId");
      let orderId = Checkout.getData("order.cart.id");
      let currency = Checkout.getData("order.cart.currency");
      let total = Checkout.getData("order.cart.prices.total");
      let data = { storeId, orderId, currency, total }

      Checkout
        .http
        .post("https://localhost:9443/checkoutUrl", { data })
        .then(function (responseBody) {
          if (!responseBody.success) return callback({success: false, error_code: responseBody.error_code});
          callback({success: true, redirect: responseBody.redirect_url, extraAuthorize: true});
        })
        .catch(function (error) { callback({success: false, error_code: "unknown_error"}); });
    },
  });

  Checkout.addPaymentOption(AcmeExternalPaymentOption);
});
